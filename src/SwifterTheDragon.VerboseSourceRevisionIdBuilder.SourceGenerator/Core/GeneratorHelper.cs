// Copyright SwifterTheDragon, and the SwifterTheDragon.VerboseSourceRevisionIdBuilder contributors, 2024-2025. All Rights Reserved.
// SPDX-License-Identifier: MIT

using System.Diagnostics;
using System.Text;

namespace SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator.Core
{
    /// <include
    /// file='../../docs/SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator.xml'
    /// path='Assembly[@name="SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator"]/Namespace[@name="Core"]/Type[@name="GeneratorHelper"]/Description/*'/>
    internal static class GeneratorHelper
    {
        #region Fields & Properties
        /// <include
        /// file='../../docs/SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator.xml'
        /// path='Assembly[@name="SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator"]/Namespace[@name="Core"]/Type[@name="GeneratorHelper"]/Property[@name="ToolName"]/*'/>
        internal static string ToolName
        {
            get
            {
                return typeof(GeneratorHelper).Assembly.GetName().Name;
            }
        }
        /// <include
        /// file='../../docs/SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator.xml'
        /// path='Assembly[@name="SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator"]/Namespace[@name="Core"]/Type[@name="GeneratorHelper"]/Property[@name="ToolVersion"]/*'/>
        internal static string ToolVersion
        {
            get
            {
                return FileVersionInfo.GetVersionInfo(typeof(GeneratorHelper).Assembly.Location).ProductVersion;
            }
        }
        #endregion Fields & Properties
        #region Methods
        /// <include
        /// file='../../docs/SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator.xml'
        /// path='Assembly[@name="SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator"]/Namespace[@name="Core"]/Type[@name="GeneratorHelper"]/Method[@name="MakeAutoGeneratedCodeHeader(System.String)"]/*'/>
        internal static string MakeAutoGeneratedCodeHeader(
            string sourceFileName = null)
        {
            StringBuilder headerBuilder = new StringBuilder()
                .AppendLine(
                    value: "// -----------------------------------------------------------------------------")
                .AppendLine(
                    value: "// <auto-generated>")
                .Append(
                    value: "//     This code was generated by \"")
                .Append(
                    value: ToolName)
                .AppendLine(
                    value: "\"")
                .Append(
                    value: "//     Version: ")
                .AppendLine(
                    value: ToolVersion);
            if (!string.IsNullOrWhiteSpace(
                value: sourceFileName))
            {
                headerBuilder.Append(
                    value: "//     from ")
                    .AppendLine(
                        value: sourceFileName);
            }
            headerBuilder.AppendLine(
                value: "//")
                .AppendLine(
                    value: "//     Changes to this file may cause incorrect behaviour and will be lost if")
                .AppendLine(
                    value: "//     the code is regenerated.")
                .AppendLine(
                    value: "// </auto-generated>")
                .AppendLine(
                    value: "// -----------------------------------------------------------------------------");
            return headerBuilder.ToString();
        }
        /// <include
        /// file='../../docs/SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator.xml'
        /// path='Assembly[@name="SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator"]/Namespace[@name="Core"]/Type[@name="GeneratorHelper"]/Method[@name="MakeAutoGeneratedFooter(System.String)"]/*'/>
        internal static string MakeAutoGeneratedFooter(
            string generatorClassName)
        {
            StringBuilder footerBuilder = new StringBuilder()
                .Append(
                    value: "// Generated by \"")
                .Append(
                    value: ToolName)
                .Append(
                    value: "\"'s \"")
                .Append(
                    value: generatorClassName)
                .AppendLine(
                    value: "\" class.");
            return footerBuilder.ToString();
        }
        #endregion Methods
    }
}
