// Copyright SwifterTheDragon, 2025. All Rights Reserved.

namespace SwifterTheDragon.VerboseSourceRevisionIdBuilder.SourceGenerator.Core
{
    /// <summary>
    /// Provides helper methods for source generation,
    /// such as making auto-generated code header comments.
    /// </summary>
    internal static class GeneratorHelper
    {
        #region Methods
        /// <summary>
        /// Makes a code header comment to properly label auto-generated code as
        /// being auto-generated when scanning the contents of a file.
        /// </summary>
        /// <param name="toolName">
        /// The name of the tool that generated the code.
        /// Specifically, the AssemblyName.
        /// </param>
        /// <param name="toolVersion">
        /// The version of the tool that generated the code.
        /// Specifically, the AssemblyVersion.
        /// </param>
        /// <param name="sourceFileName">
        /// The name of the source file that generated the code.
        /// </param>
        /// <returns>
        /// A properly formatted auto-generated header comment.
        /// </returns>
        internal static string MakeAutoGeneratedCodeHeader(
            string toolName,
            string toolVersion,
            string sourceFileName = null)
        {
            // 80 characters per line is a common standard.
            string autoGeneratedCodeHeader = "//----------------------------"
                + @"--------------------------------------------------
// <auto-generated>
//     This code was generated by """
                + toolName
                + @"""
//     Version: "
                + toolVersion
                + @"
";
            if (!string.IsNullOrWhiteSpace(
                value: sourceFileName))
            {
                autoGeneratedCodeHeader += @"//     from "
                    + sourceFileName
                    + @"
";
            }
            autoGeneratedCodeHeader += @"//
//     Changes to this file may cause incorrect behaviour and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
";
            return autoGeneratedCodeHeader;
        }
        /// <summary>
        /// Makes an auto-generated code footer comment to label auto-generated
        /// code as being auto-generated.
        /// </summary>
        /// <param name="toolName">
        /// The name of the tool that generated the code.
        /// Specifically, the assembly name.
        /// </param>
        /// <param name="generatorClassName">
        /// The name of the class that generated the code.
        /// </param>
        /// <returns>
        /// An auto-generated code footer comment.
        /// </returns>
        internal static string MakeAutoGeneratedFooter(
            string toolName,
            string generatorClassName)
        {
            string autoGeneratedFooter = "// Generated by \""
                + toolName
                + "\"'s \""
                + generatorClassName
                + @""" class.
";
            return autoGeneratedFooter;
        }
        #endregion Methods
    }
}
